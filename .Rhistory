sampled_data <- sample(fulldata$user_id,50)
sampledata <- fulldata %>%
filter(user_id %in% sampled_data)
sampledata %>%
ggplot(aes(x=rt))+
geom_histogram()
# 从数据框中抽取50个样本
sampled_data <- sample(fulldata$user_id,50)
sampledata <- fulldata %>%
filter(user_id %in% sampled_data)
sampledata %>%
ggplot(aes(x=rt),fill=user_id)+
geom_histogram()
# 从数据框中抽取50个样本
sampled_data <- sample(fulldata$user_id,50)
sampledata <- fulldata %>%
filter(user_id %in% sampled_data)
sampledata %>%
ggplot(aes(x=rt,fill=user_id))+
geom_histogram()
Sys.setenv("LANGUAGE"="EN")
# 从数据框中抽取50个样本
sampled_data <- sample(fulldata$user_id,50)
sampledata <- fulldata %>%
filter(user_id %in% sampled_data)
sampledata %>%
ggplot(aes(x=rt,fill=user_id))+
geom_histogram()
library("tidyverse")
library("tidyverse")
# set local encoding to English
if (.Platform$OS.type == 'windows') {
Sys.setlocale(category = 'LC_ALL','English_United States.1250')
} else {
Sys.setlocale(category = 'LC_ALL','en_US.UTF-8')
}
Sys.setenv(LANG = "en") # set the feedback language to English
fulldata <- read.csv("data/psa001_ratings_raw_subset.csv")#这个文件哪里来的？我记不得了
stim_info = read.csv("data/stim_info.csv")
fulldata <-  full_join (fulldata, stim_info, by = 'stim_id')
fulldata <- fulldata[complete.cases(fulldata$rt), ]
fulldata <- fulldata %>%
filter(rt>0 & rt<10000)
fulldata %>%
ggplot(aes(x=rt))+
geom_histogram() +
xlab("Reaction Time") +
theme_bw()
Sys.setenv(LANG = "CN")
fulldata %>%
ggplot(aes(x=rt))+
geom_histogram() +
xlab("Reaction Time") +
theme_bw()
Sys.setenv(LANG = "CH")
fulldata %>%
ggplot(aes(x=rt))+
geom_histogram() +
xlab("Reaction Time") +
theme_bw()
library("tidyverse")
fulldata <- read.csv("data/psa001_ratings_raw_subset.csv")#这个文件哪里来的？我记不得了
stim_info = read.csv("data/stim_info.csv")
fulldata <-  full_join (fulldata, stim_info, by = 'stim_id')
fulldata <- fulldata[complete.cases(fulldata$rt), ]
fulldata <- fulldata %>%
filter(rt>0 & rt<10000)
fulldata %>%
ggplot(aes(x=rt))+
geom_histogram() +
xlab("Reaction Time") +
theme_bw()
fulldata$log_rt <- log(fulldata$rt)
fulldata %>%
ggplot(aes(x=log_rt))+
geom_histogram() +
xlab("Reaction Time") +
xlim(2.5,12.5)+
theme_bw()
#根据正态分布去除末尾的值
fulldata <- fulldata %>%
filter(rt>245)
fulldata %>%
ggplot(aes(x=log_rt))+
geom_histogram() +
xlab("Reaction Time") +
xlim(2.5,12.5)+
theme_bw()
# 从数据框中抽取50个样本
sampled_data <- sample(fulldata$user_id,50)
sampledata <- fulldata %>%
filter(user_id %in% sampled_data)
sampledata %>%
ggplot(aes(x=rt,fill=user_id))+
geom_histogram()
# 从数据框中抽取50个样本
sampled_data <- sample(fulldata$user_id,50)
sampledata <- fulldata %>%
filter(user_id %in% sampled_data)
sampledata %>%
as.factor(user_id)
sampledata %>%
as.factor(sampledata$user_id)
options(nocolor = TRUE)
#根据正态分布去除末尾的值
fulldata <- fulldata %>%
filter(rt>245)
fulldata %>%
ggplot(aes(x=log_rt))+
geom_histogram() +
xlab("Reaction Time") +
xlim(2.5,12.5)+
theme_bw()
library("tidyverse")
library("tidyverse")
options(nocolor = TRUE)
fulldata %>%
ggplot(aes(x=rt))+
geom_histogram() +
xlab("Reaction Time") +
theme_bw()
library("tidyverse")
options(nocolor = TRUE)
fulldata %>%
ggplot(aes(x=rt))+
geom_histogram() +
xlab("Reaction Time") +
theme_bw()
# 从数据框中抽取50个样本
sampled_data <- sample(fulldata$user_id,50)
sampledata <- fulldata %>%
filter(user_id %in% sampled_data)
sampledata %>%
factor(user_id)
View(sampledata)
# 从数据框中抽取50个样本
sampled_data <- sample(fulldata$user_id,50)
sampledata <- fulldata %>%
filter(user_id %in% sampled_data)
sampledata %>%
factor(sampledata$user_id)
# 从数据框中抽取50个样本
sampled_data <- sample(fulldata$user_id,50)
sampledata <- fulldata %>%
filter(user_id %in% sampled_data)
sampledata %>%
ggplot(aes(x=rt,fill=user_id))+
geom_histogram()+
facet_wrap("~user_id")
sampledata %>%
ggplot(aes(x=rt))+
geom_histogram()+
facet_wrap("~user_id")
library("tidyverse")
library("fitdistrplus")
fit <- fitdist(fulldata$rt,"exp")
#fit <- fitdist(fulldata$rt,"exp")
fulldata %>%
group_by("user_id") %>%
fitdist(rt,"exp")
#fit <- fitdist(fulldata$rt,"exp")
#fulldata %>%
#  group_by("user_id") %>%
#  fitdist(rt,"exp")
fulldata %>%
fit <- lm(log_rt ~ 1)
View(fulldata)
#fit <- fitdist(fulldata$rt,"exp")
#fulldata %>%
#  group_by("user_id") %>%
#  fitdist(rt,"exp")
fulldata %>%
fit <- lm(fulldata$log_rt ~ 1)
#fit <- fitdist(fulldata$rt,"exp")
#fulldata %>%
#  group_by("user_id") %>%
#  fitdist(rt,"exp")
fulldata %>%
lm(log_rt ~ 1)
fit <- lm(log_rt ~ 1, data=fulldata)
View(fit)
summary(fit)
#fit <- fitdist(fulldata$rt,"exp")
#fulldata %>%
#  group_by("user_id") %>%
#  fitdist(rt,"exp")
fit <- fitdist(rt, "exp")
#fit <- fitdist(fulldata$rt,"exp")
#fulldata %>%
#  group_by("user_id") %>%
#  fitdist(rt,"exp")
fit <- fitdist(fulldata$rt, "exp")
#fit <- fitdist(fulldata$rt,"exp")
#fulldata %>%
#  group_by("user_id") %>%
#  fitdist(rt,"exp")
fit1 <- fulldata %>%
fitdist(fulldata$rt, "exp")
#fit <- fitdist(fulldata$rt,"exp")
#fulldata %>%
#  group_by("user_id") %>%
#  fitdist(rt,"exp")
fit1 <- fulldata %>%
group_by("user_id") %>%
fitdist(fulldata$rt, "exp")
#fit <- fitdist(fulldata$rt,"exp")
#fulldata %>%
#  group_by("user_id") %>%
#  fitdist(rt,"exp")
fit1 <- fulldata %>%
group_by(user_id) %>%
fitdist(fulldata$rt, "exp")
# 从数据框中抽取50个样本
sampled_data <- sample(fulldata$user_id,50)
sampledata <- fulldata %>%
filter(user_id %in% sampled_data)
sampledata %>%
ggplot(aes(x=rt))+
geom_histogram()+
facet_wrap("~user_id")
install.packages("MASS")
install.packages("MASS")
library("tidyverse")
library("fitdistrplus")
library("MASS")
exp_pdf <- function(x, rate) {
ifelse(x <= 0, 0, rate * exp(-rate * x))
}
loglikelihood <- function(params, x) {
-sum(log(exp_pdf(x, params)))
}
grouped_data <- fulldata %>%
group_by(user_id) %>%
summarize(fit_result = list(fitdistr(rt, "exponential")),
aic = -2 * loglikelihood(fit_result$estimate, rt) + 2 * 1)
grouped_data <- fulldata %>%
group_by(user_id) %>%
summarize(fit_result = list(fitdistr(rt, "exponential")),
aic = 1-loglikelihood(fit_result$estimate, rt) )
grouped_data <- fulldata %>%
group_by(user_id)
grouped_data <- fulldata %>%
group_by(user_id)
grouped_data %>%
summarize(fit_result = list(fitdistr(rt, "exponential")),
aic = -2 * loglikelihood(fit_result$estimate, rt) + 2 * 1)
exp_pdf <- function(x, rate) {
ifelse(x <= 0, 0, rate * exp(rate * x))
}
loglikelihood <- function(params, x) {
sum(log(exp_pdf(x, params)))
}
grouped_data <- fulldata %>%
group_by(user_id)
grouped_data %>%
summarize(fit_result = list(fitdistr(rt, "exponential")),
aic = -2 * loglikelihood(fit_result$estimate, rt) + 2 * 1)
View(loglikelihood)
View(exp_pdf)
grouped_data <- fulldata %>%
group_by(user_id)
fit_results <- grouped_data %>%
summarize(fit_result = list(fitdistr(rt, "exponential")),
aic = -2 * loglikelihood(fit_result$estimate, rt) + 2 * 1)
View(fit_results)
exp_pdf <- function(x, rate) {
ifelse(x <= 0, 0, rate * exp(-rate * x))
}
loglikelihood <- function(params, x) {
-sum(log(exp_pdf(x, params)))
}
grouped_data <- fulldata %>%
group_by(user_id)
fit_results <- grouped_data %>%
summarize(fit_result = list(fitdistr(rt, "exponential")),
aic = -2 * loglikelihood(fit_result$estimate, rt) + 2 * 1)
exp_pdf <- function(x, rate) {
ifelse(x <= 0, 0, rate * exp(rate * x))
}
loglikelihood <- function(params, x) {
sum(log(exp_pdf(x, params)))
}
grouped_data <- fulldata %>%
group_by(user_id)
fit_results <- grouped_data %>%
summarize(fit_result = list(fitdistr(rt, "exponential")),
aic = -2 * loglikelihood(fit_result$estimate, rt) + 2 * 1)
exp_pdf <- function(x, rate) {
ifelse(x <= 0, 0, rate * exp(rate * x))
}
loglikelihood <- function(params, x) {
-sum(log(exp_pdf(x, params)))
}
grouped_data <- fulldata %>%
group_by(user_id)
fit_results <- grouped_data %>%
summarize(fit_result = list(fitdistr(rt, "exponential")),
aic = -2 * loglikelihood(fit_result$estimate, rt) + 2 * 1)
exp_pdf <- function(x, rate) {
ifelse(x <= 0, 0, rate * exp(-rate * x))
}
loglikelihood <- function(params, x) {
sum(log(exp_pdf(x, params)))
}
grouped_data <- fulldata %>%
group_by(user_id)
fit_results <- grouped_data %>%
summarize(fit_result = list(fitdistr(rt, "exponential")),
aic = -2 * loglikelihood(fit_result$estimate, rt) + 2 * 1)
library("tidyverse")
library("fitdistrplus")
library("MASS")
library("MASS")
library("tidyverse")
library("fitdistrplus")
library("MASS")
library("tidyverse")
library("fitdistrplus")
fulldata <- read.csv("data/psa001_ratings_raw_subset.csv")#这个文件哪里来的？我记不得了
stim_info = read.csv("data/stim_info.csv")
fulldata <-  full_join (fulldata, stim_info, by = 'stim_id')
fulldata <- fulldata[complete.cases(fulldata$rt), ]
fulldata <- fulldata %>%
filter(rt>0 & rt<10000)
fulldata <- fulldata[complete.cases(fulldata$rt), ]
fulldata <- fulldata %>%
filter(rt>0 & rt<10000)
fulldata <- read.csv("data/psa001_ratings_raw_subset.csv")#这个文件哪里来的？我记不得了
stim_info = read.csv("data/stim_info.csv")
fulldata <-  full_join (fulldata, stim_info, by = 'stim_id')
fulldata <- fulldata[complete.cases(fulldata$rt), ]
fulldata <- fulldata %>%
filter(rt>0 & rt<10000)
fulldata <- fulldata[complete.cases(fulldata$rt), ]#去除NA的rt
fulldata <- fulldata %>%
filter(rt>0 & rt<10000)#删去负的和过长的反应时
fulldata %>%
ggplot(aes(x=rt))+
geom_histogram() +
xlab("Reaction Time") +
theme_bw()
fulldata$log_rt <- log(fulldata$rt)
fulldata %>%
ggplot(aes(x=log_rt))+
geom_histogram() +
xlab("Reaction Time") +
xlim(2.5,12.5)+
theme_bw()
#根据正态分布去除末尾的值
fulldata <- fulldata %>%
filter(rt>245)
fulldata %>%
ggplot(aes(x=log_rt))+
geom_histogram() +
xlab("Reaction Time") +
xlim(2.5,12.5)+
theme_bw()
# 从数据框中抽取50个样本
sampled_data <- sample(fulldata$user_id,50)
sampledata <- fulldata %>%
filter(user_id %in% sampled_data)
sampledata %>%
ggplot(aes(x=rt))+
geom_histogram()+
facet_wrap("~user_id")
exp_fulldata <- fulldata %>%
group_by(user_id) %>%
mutate(p_value = ifelse(all(!is.na(rt)),ks.test(rt,"pexp")$p.value, NA)) %>%
filter(p_value>0.05) %>%
ungroup() %>%
select(-p_value)
exp_fulldata <- fulldata %>%
group_by(user_id) %>%
mutate(p_value = ifelse(all(!is.na(rt)),ks.test(rt,"pexp")$p.value, NA)) %>%
filter(p_value>0.05) %>%
ungroup() %>%
select(-c(p_value))
exp_fulldata <- fulldata %>%
group_by(user_id) %>%
mutate(p_value = ifelse(all(!is.na(rt)),ks.test(rt,"pexp")$p.value, NA)) %>%
filter(p_value>0.05) %>%
ungroup()
View(exp_fulldata)
dplyr::last_dplyr_warnings()
exp_fulldata <- fulldata %>%
group_by(user_id) %>%
mutate(rt_clean = rt[!is.na(rt)],
p_value = ifelse(all(!is.na(rt)),ks.test(rt_clean,"pexp")$p.value, NA)) %>%
filter(p_value>0.05) %>%
ungroup()
rt_dist <- fulldata %>%
group_by(user_id) %>%
summarize(rt = list(na.omit(rt))) %>%
mutate(rt_dist = map(rt, ecdf)) %>%
mutate(p_value = map_dbl(rt, function(x) ad.test(x, "exp")$p.value))
install.packages("nortest")
library("MASS")
library("tidyverse")
library("fitdistrplus")
library("nortest")
rt_dist <- fulldata %>%
group_by(user_id) %>%
summarize(rt = list(na.omit(rt))) %>%
mutate(rt_dist = map(rt, ecdf)) %>%
mutate(p_value = map_dbl(rt, function(x) ad.test(x, "exp")$p.value))
logLik_exponential <- function(params, x) {
n <- length(x)
-n*log(params) - sum(x)/params
}
result <- fulldata %>%
group_by(user_id) %>%
summarize(p_value = ad.test(rt, "exp")$p.value, .groups = "drop") %>%
filter(!is.na(p_value)) %>%
mutate(fit_result = map(rt, ~fitdistr(.x, "exponential")),
logLik = map_dbl(fit_result, ~logLik_exponential(.x$estimate, .x$data)),
AIC = map_dbl(fit_result, ~AIC(logLik = .x)),
BIC = map_dbl(fit_result, ~BIC(logLik = .x)))
exp_test <- fulldata %>%
group_by(user_id) %>%
summarize(p_value = ad.test(rt, "exponential")$p.value)
exp_test <- fulldata %>%
group_by(user_id) %>%
summarize(p_value = ad.test(rt, "exp")$p.value)
exp_test <- fulldata %>%
group_by(user_id) %>%
summarize(p_value = ad.test(rt, exp)$p.value)
exp_test <- fulldata %>%
group_by(user_id) %>%
summarize(p_value = ad.test(rt, "exp")$p.value)
exp_test <- fulldata %>%
group_by(user_id) %>%
summarize(p_value = ad.test(rt, "exponential")$p.value)
library("MASS")
library("tidyverse")
library("fitdistrplus")
library("nortest")
fulldata <- read.csv("data/psa001_ratings_raw_subset.csv")#这个文件哪里来的？我记不得了
stim_info = read.csv("data/stim_info.csv")
fulldata <-  full_join (fulldata, stim_info, by = 'stim_id')
fulldata <- fulldata[complete.cases(fulldata$rt), ]#去除NA的rt
fulldata <- fulldata %>%
filter(rt>0 & rt<10000)#删去负的和过长的反应时
fulldata %>%
ggplot(aes(x=rt))+
geom_histogram() +
xlab("Reaction Time") +
theme_bw()
fulldata$log_rt <- log(fulldata$rt)
fulldata %>%
ggplot(aes(x=log_rt))+
geom_histogram() +
xlab("Reaction Time") +
xlim(2.5,12.5)+
theme_bw()
#根据正态分布去除末尾的值
fulldata <- fulldata %>%
filter(rt>245)
fulldata %>%
ggplot(aes(x=log_rt))+
geom_histogram() +
xlab("Reaction Time") +
xlim(2.5,12.5)+
theme_bw()
# 从数据框中抽取50个样本
sampled_data <- sample(fulldata$user_id,50)
sampledata <- fulldata %>%
filter(user_id %in% sampled_data)
sampledata %>%
ggplot(aes(x=rt))+
geom_histogram()+
facet_wrap("~user_id")
fulldata <- read.csv("data/psa001_ratings_raw_subset.csv")#这个文件哪里来的？我记不得了
stim_info = read.csv("data/stim_info.csv")
fulldata <-  full_join (fulldata, stim_info, by = 'stim_id')
fulldata <- fulldata[complete.cases(fulldata$rt), ]#去除NA的rt
fulldata <- read.csv("data/psa001_ratings_raw_subset.csv")#这个文件哪里来的？我记不得了
stim_info = read.csv("data/stim_info.csv")
fulldata <-  full_join (fulldata, stim_info, by = 'stim_id')
fulldata <- fulldata[complete.cases(fulldata$rt), ]#去除NA的rt
#fulldata <- fulldata %>%
#  filter(rt>0 & rt<10000)#删去负的和过长的反应时
fulldata <- fulldata[complete.cases(fulldata$rt), ]#去除NA的rt
fulldata <- fulldata %>%
filter(rt>0 & rt<10000)#删去负的和过长的反应时
fulldata <- fulldata[complete.cases(fulldata$rt), ]#去除NA的rt
fulldata <- fulldata %>%
filter(rt>0 & rt<10000)#删去负的和过长的反应时
summary(fulldata)
fulldata <- fulldata[complete.cases(fulldata$rt), ]#去除NA的rt
fulldata <- fulldata %>%
filter(rt>0 & rt<10000) %>%
na.omit()#删去负的和过长的反应时
summary(fulldata)
fulldata <- fulldata[complete.cases(fulldata$rt), ]#去除NA的rt
fulldata <- fulldata %>%
filter(rt>0 & rt<10000) %>% #删去负的和过长的反应时
summary(fulldata)
fulldata <- read.csv("data/psa001_ratings_raw_subset.csv")#这个文件哪里来的？我记不得了
stim_info = read.csv("data/stim_info.csv")
fulldata <-  full_join (fulldata, stim_info, by = 'stim_id')
fulldata <- fulldata[complete.cases(fulldata$rt), ]#去除NA的rt
fulldata <- fulldata %>%
filter(rt>0 & rt<10000) %>% #删去负的和过长的反应时
summary(fulldata)
fulldata <- fulldata[complete.cases(fulldata$rt), ]#去除NA的rt
fulldata <- read.csv("data/psa001_ratings_raw_subset.csv")#这个文件哪里来的？我记不得了
stim_info = read.csv("data/stim_info.csv")
fulldata <-  full_join (fulldata, stim_info, by = 'stim_id')
fulldata <- fulldata[complete.cases(fulldata$rt), ]#去除NA的rt
fulldata <- fulldata %>%
filter(rt>0 & rt<10000) #删去负的和过长的反应时
summary(fulldata)
