---
title: "ethnicity"
author: "Pac"
date: '2022-11-08'
output: html_document
---

```{r}
library("tidyverse")
library("randomForest")
```

```{r}
fulldata <- read.csv("data/TrainSet.csv")
```

```{r}
fulldata <- fulldata %>% 
  filter(rt<10000 & rt>0)
```

###随机森林
```{r}
rating_randomforest <- fulldata %>% 
  select("rating","rt","language","trait","country","sex","Race","Gender","ethnicity.y")
rating_randomforest <- rating_randomforest %>% 
  na.omit(rating_randomforest)

#n<-length(names(rating_randomforest)) 

#rate=1

#for(i in 1:(n-1)){
#  set.seed(1234)
#  rf_train<-randomForest(as.factor(rating_randomforest$rating)~rating+rt+language,data=rating_randomforest,mtry=i,ntree=500)
#  rate[i]<-mean(rating_randomforest$err.rate)   #计算基于OOB数据的模型误判率均值
#  print(rf_train)    
#}

```

```{r}
set.seed(1234)
rf_rating <- randomForest(as.factor(rating_randomforest$rating)~.,data=rating_randomforest,mtry=8,ntree=500,proximity=FALSE)
```

```{r}
print(rf_rating)
importance(rf_rating,type = 2)
varImpPlot(rf_rating)
```









