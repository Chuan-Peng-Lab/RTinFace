---
title: "Untitled"
author: "Pac"
date: '2022-11-21'
output: html_document
---

#libraries
```{r}
library("tidyverse")
library("bruceR")
```


```{r}
fulldata <- read.csv("data/TrainSet.csv")
```

```{r}
fulldata <- fulldata %>% 
  filter(rt<5000 & rt>0)
```


```{r}
ethnicity_participants <- fulldata %>% 
  group_by(ethnicity.x) %>% 
  summarise(N=n())

chinese <- fulldata %>% 
  filter(ethnicity.x %in% c("布依族","藏族","哈萨克族","汉","汉族","漢","回","回族","傈僳族","满族","蒙古族","苗","畲族","土家族","壮"))#这里不能使用“==”的判别，
```

#×这里应该是重复测量方差分析,图也要重新画
```{r}
pic_chinese <- chinese %>% 
  ggplot(aes(x=ethnicity.y,y=rt),fill=y)+
  geom_boxplot()+
  theme_minimal()
remove(pic_chinese)


#chinese_anova <- chinese %>% 
#  MANOVA( dv = "rt", between = "ethnicity.y")

```

#整理数据框
```{r}
chinese <-chinese %>% 
  select(c("user_id","rt","ethnicity.y")) %>% 
  group_by(user_id,ethnicity.y) %>% 
  summarise(rt=mean(rt)) %>% 
  ungroup()
  
chinese %>% 
  ggplot(aes(x=ethnicity.y,y=rt))+
  geom_boxplot()+
  theme_minimal()

  
chinese_anova <- chinese %>% 
  spread(key = ethnicity.y,value = rt,convert = TRUE) %>% 
  na.omit()

names(chinese_anova)[2:5] <- c("A1","A2","A3","A4")

chinese_anova %>% 
  MANOVA(dvs = c("A1","A2","A3","A4"),dvs.pattern="A(.)",within = "A")


#spread(data = chinese_within, ethnicity.y, rt, convert = TRUE)
```







